package me.xginko.aef.modules.patches.commandsign;

import me.xginko.aef.utils.permissions.AEFPermission;
import org.bukkit.event.EventHandler;
import org.bukkit.event.EventPriority;
import org.bukkit.event.Listener;

public class SignCommandListener implements Listener {

    private static boolean isSupported;

    static {
        try {
            Class.forName("io.papermc.paper.event.player.PlayerSignCommandPreprocessEvent");
            isSupported = true;
        } catch (ClassNotFoundException e) {
            isSupported = false;
        }
    }

    @EventHandler(priority = EventPriority.HIGHEST, ignoreCancelled = true)
    private void onSignCommandPreprocess(io.papermc.paper.event.player.PlayerSignCommandPreprocessEvent event) {
        if (!event.getPlayer().hasPermission(AEFPermission.BYPASS_PREVENTION_COMMANDSIGN.bukkit())) {
            event.setCancelled(true);
        }
    }

    public static boolean isSupported() {
        return isSupported;
    }
}
